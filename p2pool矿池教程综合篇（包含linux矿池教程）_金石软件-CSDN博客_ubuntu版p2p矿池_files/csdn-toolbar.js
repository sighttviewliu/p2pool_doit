"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null===e||void 0===e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),a=1;a<arguments.length;a++){var r=arguments[a];if(null!==r&&void 0!==r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},writable:!0,configurable:!0,enumerable:!1}),window._hmt=window._hmt||[],function(){function e(e){for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var a=t[n].split("=");if(a[0]==e&&"UD"==e)return decodeURIComponent(a[1]);if(a[0]==e)return decodeURI(a[1])}}function t(){var e=window.location.host;return 0===e.indexOf("blog")?"UA-127895514-2":0===e.indexOf("download")?"UA-127895514-8":0===e.indexOf("edu")?"UA-127895514-9":0===e.indexOf("bbs")?"UA-127895514-4":0===e.indexOf("ask")?"UA-127895514-5":0===e.indexOf("gitbook")?"UA-127895514-10":0===e.indexOf("iteye")?"UA-127895514-6":0===e.indexOf("passport")?"UA-127895514-7":0===e.indexOf("so")?"UA-127895514-3":0===e.indexOf("www")?e.indexOf("iteye")>0?"UA-127895514-6":"UA-127895514-1":""}var n="6bcd52f51e9b3dce32bec4a3997715ac",a=function(){var e="6bcd52f51e9b3dce32bec4a3997715ac",t=$('meta[name="toolbar"]');if(t.length){var n=t.attr("content")||{};n=JSON.parse(n),e=n.hmId||e}return e}();!function(e){for(var t=document.cookie.split("; "),a=0;a<t.length;a++){var r=t[a].split("=");/^Hm\_.+\_.+$/.test(r[0])&&-1===r[0].indexOf(e)&&-1===r[0].indexOf(n)&&(document.cookie=r[0]+"="+escape("")+";max-age=0;domain=.csdn.net;path=/")}}(a),function(e){_hmt.push(["_setAccount",e])}(a),function(){try{var t=!!e("UN"),n=!!e("UserName"),a=e("p_uid");a=a?a.substr(1,1):0,_hmt.push(["_setUserProperty",{islogin:+t,isonline:+n,isvip:+(1==a)}]),n&&_hmt.push(["_setUserId",e("UserName")]),_hmt.push(["_setUserTag","6525",e("uuid_tt_dd")])}catch(e){void 0}}();var r=document.createElement("script");r.src="https://hm.baidu.com/hm.js?"+a;var o=document.getElementsByTagName("script")[0];if(o.parentNode.insertBefore(r,o),document.referrer.indexOf("google.com")>-1){var s=function(){dataLayer.push(arguments)},i=document.createElement("script");i.src="https://www.googletagmanager.com/gtag/js?id="+t(),o.parentNode.insertBefore(i,o),window.dataLayer=window.dataLayer||[];var c=e("UserName")||"";s("js",new Date),s("config",t()),c&&s("set",{user_id:c})}}(),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://g.csdnimg.cn/??asdf/1.1.3/trackad.js,iconfont/nav/iconfont-1.0.1.js,notification/1.3.8/notify.js,notification/1.3.8/main.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),function(){function e(e,t,n){var a=new Date;if(-1==n)return void(document.cookie=e+"="+escape(t)+";domain=.csdn.net;path=/");if(n)a.setTime(a.getTime()+n);else{a.setTime(a.getTime()+2592e6)}document.cookie=e+"="+escape(t)+";expires="+a.toGMTString()+";domain=.csdn.net;path=/"}var t=["blog","bbs","download","ask","edu","biwen"],n=document.referrer;if(""!==n)if(n.indexOf(".csdn.net")>-1)for(var a=0;a<t.length;a++)n.indexOf(t[a]+".csdn.net")>-1&&e("c_ref",n,-1);else e("c_ref",n.split("?")[0],-1)}(),window._hmt=window._hmt||[],function(e,t){function n(e){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}function a(e,t){var n=document.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(n.onreadystatechange=null,t&&t())}:n.onload=function(){t&&t()},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)}function r(e){for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var a=t[n].split("=");if(a[0]==e&&"UD"==e)return decodeURIComponent(a[1]);if(a[0]==e)return decodeURI(a[1])}}function o(e,t,n){var a=new Date;if(-1==n)return void(document.cookie=e+"="+escape(t)+";domain=.csdn.net;path=/");if(n)a.setTime(a.getTime()+n);else{a.setTime(a.getTime()+2592e6)}document.cookie=e+"="+escape(t)+";expires="+a.toGMTString()+";domain=.csdn.net;path=/"}function s(e){var t=new Date;document.cookie=e+"="+escape("1")+";max-age=0;expires="+t.toGMTString()+";domain=.csdn.net;path=/"}function a(e,t){var n=document.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(n.onreadystatechange=null,t&&t())}:n.onload=function(){t&&t()},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)}function i(e,t){var n,a=null;return function(){var r=this,o=new Date;o-a-t>0?(n&&(clearTimeout(n),n=null),e.apply(r,arguments),a=o):n||(n=setTimeout(function(){e.apply(r,arguments)},t))}}function c(e){e=e.replace("https://","");var t=e.split(".")[0];return~location.host.indexOf(t)}function d(e){return 0==e.length?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&#39;").replace(/\"/g,"&quot;")}function l(n){if("[object Object]"==Object.prototype.toString.call(n)){var a=t("#csdn-toolbar"),r=n.need_first_suspend||!1,o=n.need_little_suspend||!1,s=n.little_tool_id||"",c=n.little_need_insert_type||"",d=n.need_change_function||"",p="",u="";if(1!=r||1!=o){if(o&&""!=s&&(a=t(s)),o&&s&&""!=c&&(p="."+c,u=t(p)),0===a.length)return void b.push(l.bind(this,n));var h=i(function(){if((document.documentElement.scrollTop||document.body.scrollTop)>=50)a.css({position:"fixed",top:"0",left:"0","z-index":"9999",width:"100%"}),o&&t(".secodn_level_csdn_logo").length&&t(".secodn_level_csdn_logo").css({display:"block"}),o&&""!=c&&(t("body").addClass("toolbar-second-drop"),"onlySearch"==c?t("#csdn_tool_otherPlace").append(u):"onlyUser"==c?t("#csdn_tool_otherPlace").append(u):"searchUser"==c&&(t("#csdn_tool_otherPlace").append(t(".onlySearch")),t("#csdn_tool_otherPlace").append(t(".onlyUser")))),"function"==typeof d&&d("fixed");else{if(a.css({position:"static","z-index":""}),o&&t(".secodn_level_csdn_logo").length&&t(".secodn_level_csdn_logo").css({display:"none"}),o&&""!=c){t("body").removeClass("toolbar-second-drop");var e=t("#csdn-toolbar .toolbar-container");"onlySearch"==c?e.find(".toolbar-menus").after(u):"onlyUser"==c?e.append(u):"searchUser"==c&&(e.append(t(".onlySearch")),e.append(t(".onlyUser")))}"function"==typeof d&&d("noFixed")}},80);(document.documentElement.scrollTop||document.body.scrollTop)>50&&h(),t(e).on("scroll",h)}}}function p(){var t=e.location.host,n=t.split(".")[0],a="";switch(n){case"www":case"blog":case"bbs":a="";break;case"download":a="doc";break;case"ask":case"gitchat":case"geek":a="";break;case"edu":a="course";break;default:a=""}return t.indexOf(".blog.csdn.net")>-1&&(a="blog"),a}function u(e){var t={};return location.href.replace(/([^*#&=?]+)=([^*#&=?]+)/g,function(){for(var e=arguments.length,n=Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=n[1],o=n[2];t[r]=o}),e?t[e]:t}function h(e){try{e&&t(document).trigger(e)}catch(e){void 0}}function m(){this.currentUser={userName:"",userNick:'<a class="set-nick" href="https://passport.csdn.net/account/profile">设置昵称<span class="write-icon"></span></a>',desc:'<a class="fill-dec" href="//my.csdn.net" target="_blank">编辑自我介绍，让更多人了解你<span class="write-icon"></span></a>',avatar:""},this.hasLogin=!1,this.$container="",this.announcement=0,this.logoData={title:"CSDN首页",url:{default:"https://csdnimg.cn/cdn/content-toolbar/csdn-logo.png?v=20200416.1",dark:"https://g.csdnimg.cn/common/csdn-toolbar/images/csdn-logo.png",home:"https://g.csdnimg.cn/common/csdn-toolbar/images/csdn-logo.png"}},this.navData=[{id:"blog",name:"博客",url:"https://blog.csdn.net/",report:{spm:"3001.4477",mod:"popu_336",dest:"https://blog.csdn.net/"},children:[{name:"创作中心",url:"https://mp.csdn.net?utm_medium=fe.tool_bar_second.blog.creative_center",report:{spm:"3001.5106",mod:"1593505904_001"}}]},{id:"edu",name:"学院",url:"https://edu.csdn.net/",report:{spm:"3001.4482",mod:"popu_336",dest:"https://edu.csdn.net/"},children:[]},{id:"download",name:"下载",url:"https://download.csdn.net/",report:{spm:"3001.4483",mod:"popu_336",dest:"https://download.csdn.net/"},children:[{name:"我的资源",url:"https://mp.csdn.net/console/upDetailed?utm_medium=fe.tool_bar_second.download.my_resources",report:{spm:"3001.5107",mod:"1593505904_002"}}]},{id:"bbs",name:"论坛",url:"https://bbs.csdn.net/",report:{spm:"3001.4491",mod:"popu_336",dest:"https://bbs.csdn.net/"},children:[{name:"我的积分",url:"https://mp.csdn.net/console/upDetailed?utm_medium=fe.tool_bar_second.download.my_points",report:{spm:"3001.5135",mod:"1593505904_003"}}]},{id:"aks",name:"问答",url:"https://ask.csdn.net/",report:{spm:"3001.4492",mod:"popu_336",dest:"https://ask.csdn.net/"},children:[]},{id:"live",name:"直播",url:"https://live.csdn.net/",report:{mod:"popu_336",dest:"https://live.csdn.net/",extend1:"直播"},children:[]},{id:"job",name:"招聘",url:"https://job.csdn.net/",report:{mod:"popu_336",dest:"https://job.csdn.net/"},children:[]},{id:"vip",name:"VIP会员",url:"https://mall.csdn.net/vip",report:{spm:"3001.4496",mod:"popu_336",dest:"https://mall.csdn.net/vip"},children:[{name:"VIP权益",url:"https://csdn.net/vip?utm_medium=fe.tool_bar_second.download.vip",report:{spm:"3001.4497",mod:"1593505904_004"}}]}],this.personMenuData=[],this.advertData={date:{start:"2020/07/03 08:50:00",end:"2020/07/04 17:30:00"},background:{large:"https://csdnimg.cn/public/publick_img/ad_20200703_toolbar325.jpg",default:"https://csdnimg.cn/public/publick_img/ad_20200703_toolbar80_2.jpg"},color:"#027ef2",url:"https://aiprocon.csdn.net/p/live?utm_source=live_703"},this.init()}e.csdn=e.csdn||{},e.csdn.configuration_tool_parameterv=l;var g=["csdn-toolbar-default","csdn-toolbar-dark","csdn-toolbar-home"],b=[],f=0;m.prototype={constructor:m,init:function(){var e=this;e.checkLogin(function(t){t.userName&&(e.hasLogin=!0,_hmt.push(["_setUserTag","5744",t.userName])),e.setPersonMenuData()}),e.getToolbarData(e.render)},render:function(e){var t=this;t.renderToolbar(),t.renderLogo(),t.renderNav(),t.renderSearch(),t.renderBtns(),t.getHotSearchWordData(t.setSearchInputPlaceholder.bind(t)),t.chain()},setPersonMenuData:function(){this.personMenuData=[{name:"我的关注",url:"https://i.csdn.net/#/uc/follow-list",report:{mod:"popu_789",dest:"https://i.csdn.net/#/uc/follow-list",spm:"3001.5109"},icon:"toolbar-icon-follow",class:""},{name:"我的收藏",url:"https://i.csdn.net/#/uc/collection-list",report:{mod:"popu_789",dest:"https://i.csdn.net/#/uc/collection-list",spm:"3001.5110"},icon:"toolbar-icon-collect",class:""},{name:"个人中心",url:"https://i.csdn.net/#/uc/profile",report:{mod:"popu_789",dest:"https://i.csdn.net/#/uc/profile",spm:"3001.5111"},icon:"toolbar-icon-profile",class:""},{name:"帐号设置",url:"https://i.csdn.net/#/account/index",report:{mod:"popu_789",dest:"https://i.csdn.net/#/account/index",spm:"3001.5112"},icon:"toolbar-icon-account",class:"toolbar-subMenu-border"},{name:"我的博客",url:"https://blog.csdn.net/"+this.currentUser.userName,report:{mod:"popu_789",dest:"https://blog.csdn.net/",spm:"3001.5113"},icon:"toolbar-icon-blog",class:""},{name:"管理博客",url:"https://mp.csdn.net/console/article",report:{mod:"popu_789",dest:"https://mp.csdn.net/console/article",spm:"3001.5114"},icon:"toolbar-icon-mp",class:""},{name:"我的学院",url:"https://edu.csdn.net/mycollege",report:{mod:"popu_789",dest:"https://edu.csdn.net/mycollege",spm:"3001.5115"},icon:"toolbar-icon-edu",class:""},{name:"我的下载",url:"https://mp.csdn.net/console/upDetailed",report:{mod:"popu_789",dest:"https://mp.csdn.net/console/upDetailed",spm:"3001.5116"},icon:"toolbar-icon-download",class:""},{name:"我的书架",url:"https://book.csdn.net/bookshelf",report:{mod:"popu_789",dest:"https://book.csdn.net/bookshelf",spm:"3001.5117"},icon:"toolbar-icon-book",class:"toolbar-subMenu-border"},{name:"我的钱包",url:"https://i.csdn.net/#/wallet/index",report:{mod:"popu_789",dest:"https://i.csdn.net/#/wallet/index",spm:"3001.5136"},icon:"toolbar-icon-wallet",class:""},{name:"我的订单",url:"https://mall.csdn.net/myorder",report:{mod:"popu_789",dest:"https://mall.csdn.net/myorder",spm:"3001.5137"},icon:"toolbar-icon-order",class:"toolbar-subMenu-border"},{name:"帮助",url:"https://blog.csdn.net/blogdevteam/article/details/103478461",report:{mod:"popu_789",dest:"https://blog.csdn.net/blogdevteam/article/details/103478461",spm:"3001.5138"},icon:"toolbar-icon-help",class:""},{name:"退出",url:"javascript:;",report:{spm:"3001.5139"},icon:"toolbar-icon-logout",class:"toolbar-btn-logout"}]},getAvatarByAu:function(e){return!!e&&"https://profile.csdnimg.cn/"+e.split("").join("/")+"/2_"+(this.currentUser.userName&&this.currentUser.userName.toLowerCase())},checkLogin:function(e){var t=r("AU"),n=r("UserNick"),a=r("UserName"),o=r("UD");this.currentUser.userNick=n,this.currentUser.userName=a,this.currentUser.avatar=this.getAvatarByAu(t),this.currentUser.desc=o?d(o.replace(/\+/g," ")):this.currentUser.desc,e&&e(this.currentUser)},renderToolbar:function(){var e=this,n=e.getToolbarStyle(),a=t('<div id="csdn-toolbar">\n                    <div class="toolbar-inside" '+(n?'style="'+n+'"':"")+'>\n                      <div class="toolbar-container csdn-toolbar-clearfix">\n                        <div class="toolbar-logo toolbar-subMenu-box csdn-toolbar-fl"></div>\n                        <ul class="toolbar-menus csdn-toolbar-fl"></ul>\n                        <div class="toolbar-search onlySearch csdn-toolbar-fl"></div>\n                        <div class="toolbar-btns onlyUser csdn-toolbar-fr"></div>\n                      </div>\n                    </div>\n                  </div>');return t("body").prepend(a),e.$container=a.find(".toolbar-container"),e.$logoBox=a.find(".toolbar-logo"),e.$NavBox=a.find(".toolbar-menus"),e.$searchBox=a.find(".toolbar-search"),e.$btnsBox=a.find(".toolbar-btns"),t(document).on("click",function(n){0!==t(n.target).closest(".toolbar-search").length||e.searchInputFocus||(e.clearSeachDropMenu(),e.toggleSearchBarInput())}),this},renderNav:function(){var e=this,t=""+this.navData.map(function(t){t.active=c(t.url);var n=((new Date).getTime(),e.isEffectiveTime(t.icon));return'<li class="'+(t.active?"active ":"")+(t.children.length?"toolbar-subMenu-box":"")+"\">\n                                <a data-report-click='"+JSON.stringify(t.report)+"' "+(t.report.spm?'data-report-query="spm='+t.report.spm+'"':"")+" href='"+t.url+"'>"+t.name+" "+(n?"<img style='"+t.icon.style+'\'" src="'+t.icon.url+'">':"")+"</a>\n                                "+(t.children.length?'<div class="toolbar-subMenu">\n                                    '+t.children.map(function(e){return"<a data-report-click='"+JSON.stringify(e.report)+"' data-report-query=\"spm="+e.report.spm+'" target="_blank" href=\''+e.url+"'>"+e.name+"</a>"}).join("")+"\n                                  </div>":"")+"\n                              </li>"}).join("");return this.$NavBox.append(t),this},renderLogo:function(){var e=["default","dark","home"],t=e[f],n='<a data-report-click=\'{"spm":"3001.4476"}\' data-report-query="spm=3001.4476" href="https://www.csdn.net"><img title="'+this.logoData.title+'" src="'+this.logoData.url[t]+'"></a>\n                    <div class="toolbar-subMenu">\n                      <img width="96" height="96" src="https://csdnimg.cn/public/common/toolbar/images/csdnqr@2x.png">\n                    </div>';return void 0,this.$logoBox.append(n),this},renderSearch:function(){var e=this,n=t('<div class="toolbar-search-container">\n                    <input id="toolbar-search-input" type="text" value="" placeholder="'+this.getSearchInputPlaceHolder()+'">\n                    <button id="toolbar-search-button"></button>\n                  </div>');return n.on("focus","#toolbar-search-input",function(n){""===t(this).val()&&(e.renderSearchHistoryDropMenu(),e.getHotSearchData()),e.toggleSearchBarInput("focus"),e.searchInputFocus=!0}).on("blur","#toolbar-search-input",function(t){e.searchInputFocus=!1}).on("input","#toolbar-search-input",function(n){var a=t(this),r=a.val();void 0,""===r?(e.renderSearchHistoryDropMenu(),e.getHotSearchData()):t(".toolbar-search-drop-menu").remove()}).on("click","button",function(n){var a=t("#toolbar-search-input").val();return e.clickSearchBtnHandler.call(e,a),e.buriedPoint({spm:"3001.4498"}),!1}).on("keyup","#toolbar-search-input",function(e){13===e.keyCode&&t("#toolbar-search-button").trigger("click")}),this.$searchBox.append(n),this.renderBaiduSearchDropMenu(),this},renderBtns:function(){var e=this,n=t('<div class="toolbar-btn toolbar-btn-write csdn-toolbar-fl '+(this.hasLogin?"toolbar-subMenu-box":"")+'">\n                    <a data-report-click=\'{"spm":"3001.4503"}\' data-report-query="spm=3001.4503" href="https://mp.csdn.net"><i></i>创作中心</a>\n                    '+(this.hasLogin?'<div class="toolbar-subMenu">\n                    <a data-report-click=\'{"spm":"3001.4504", "mod":"1586414474_001","dest":"https://mp.csdn.net/console/editor/html"}\' data-report-query="spm=3001.4504" target="_blank" href="https://mp.csdn.net/console/editor/html">写博客</a>\n                    <a data-report-click=\'{"spm":"3001.4505", "mod":"1586414474_002","dest":"https://blink.csdn.net/?utm_source=103209678"}\' data-report-query="spm=3001.4505" target="_blank" href="https://blink.csdn.net/?utm_source=103209678">发Blink</a>\n                    </div>':"")+'\n                  </div>\n                  <a data-report-click=\'{"spm":"3001.4506"}\' data-report-query="spm=3001.4506" href="https://i.csdn.net/#/uc/collection-list" class="toolbar-btn toolbar-btn-collect csdn-toolbar-fl">收藏</a>\n                  '+(this.hasLogin?'<a data-report-click=\'{"spm":"3001.4507"}\' data-report-query="spm=3001.4507" href="https://blog.csdn.net/nav/watchers" class="toolbar-btn toolbar-btn-collect csdn-toolbar-fl">动态</a>':"")+'\n                  <div class="toolbar-btn toolbar-btn-msg csdn-toolbar-fl">\n                    <div class="toolbar-subMenu-box">\n                      <a data-report-click=\'{"spm":"3001.4508"}\' data-report-query="spm=3001.4508" id="toolbar-remind" href="https://i.csdn.net/#/msg/index">消息</a>\n                    </div>\n                    <div class="toolbar-msg-box"></div>\n                  </div>\n                  <div class="toolbar-btn-login csdn-toolbar-fl '+(this.hasLogin?"toolbar-subMenu-box":"")+'">\n                    '+(this.currentUser.avatar?'<a class="hasAvatar" href="https://i.csdn.net"><img src="'+this.currentUser.avatar+'"></a>':' <a data-report-click=\'{"spm":"3001.5105"}\' data-report-query="spm=3001.5105" href="https://passport.csdn.net/account/login">登录/注册</a>')+"\n                    "+(this.hasLogin?'<div class="toolbar-subMenu">'+this.personMenuData.map(function(e){return"<a "+(e.report?"data-report-click='"+JSON.stringify(e.report)+"' data-report-query='spm="+e.report.spm+"'":"")+" href='"+e.url+"' class='"+e.class+"'><i class=\"toolbar-icon "+e.icon+'"></i>'+e.name+"</a>"}).join("")+"</div>":"")+"\n                  </div>");return this.$btnsBox.append(n),n.on("click",".toolbar-btn-logout",function(){e.clickLogoutBtnHandler()}),this.$msgBox=n.find(".toolbar-msg-box"),this},renderMsgMenu:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n='<div class="toolbar-subMenu">\n                    <a id="toolbar-announcement" href="'+(e.announcement?e.announcement.announcementUrl:"javaScript:;")+'">公告'+(e.announcement&&e.announcement.announcementCount?"<i>"+(e.announcement.announcementCount>99?"99+":e.announcement.announcementCount)+"</i>":"")+"</a>\n                    "+(this.hasLogin?'<a href="https://i.csdn.net/#/msg/index">评论'+(e.comment?"<i>"+(e.comment>99?"99+":e.comment)+"</i>":"")+'</a>\n                                      <a href="https://i.csdn.net/#/msg/attention">关注'+(e.follow?"<i>"+(e.follow>99?"99+":e.follow)+"</i>":"")+'</a>         \n                                      <a href="https://i.csdn.net/#/msg/like">点赞'+(e.thumb_up?"<i>"+(e.thumb_up>99?"99+":e.thumb_up)+"</i>":"")+'</a>\n                                      <a href="https://im.csdn.net/im/main.html">私信'+(e.im?"<i>"+(e.im>99?"99+":e.im)+"</i>":"")+'</a>\n                                      <a href="https://i.csdn.net/#/msg/answer">回答'+(e.invitation?"<i>"+(e.invitation>99?"99+":e.invitation)+"</i>":"")+'</a>\n                                      <a href="https://i.csdn.net/#/msg/notice">系统通知'+(e.system?"<i>"+(e.system>99?"99+":e.system)+"</i>":"")+'</a>\n                                      <a href="https://i.csdn.net/#/msg/setting">消息设置</a>':"")+"     \n                  </div>";this.$btnsBox.find(".toolbar-btn-msg .toolbar-subMenu-box").append(n),t("#toolbar-announcement").off("click").on("click",this.clickAnnouncementHandler.bind(this)),this.hasLogin||e.announcement&&this.setRemind(e.announcement.announcementUrl,e.announcement.announcementCount),b.length&&b.forEach(function(e){return e()})},renderCoupon:function(n){var a=t('<a href="https://i.csdn.net/#/msg/notice" class="toolbar-msg-coupon">你有一张VIP限时优惠券哦</a>');n&&n>0&&-1===e.location.href.indexOf("assign_skin_id")&&(this.$msgBox.append(a),setTimeout(function(){a.remove()},5e3))},renderGuide:function(e){var n=this,a=r("c-toolbar-loginguide"),s=t('<span class="toolbar-msg-guide"><a href="https://i.csdn.net/#/msg/index">登录查看未读消息</a><i></i></span>');!a&&e&&(s.find("i").click(function(e){o("c-toolbar-loginguide",1,864e5),s.remove()}),!n.hasLogin&&e>0&&this.$msgBox.append(s))},renderLiveMsg:function(e){var n=this;if(e&&1===e.status){var a=t('<div class="toolbar-msg-live">\n                      <a class="toolbar-msg-live-title" target="_blank" href="'+e.url+'">'+e.title+'</a>\n                      <p class="toolbar-msg-live-count"><i></i>'+e.count+'人在看</p>\n                      <div class="toolbar-msg-live-avatar"><span><img src="'+e.avatar+'" alt=""></span></div>\n                      <span class="toolbar-msg-live-close"></span>\n                    </div>');a.on("click",".toolbar-msg-live-close",function(e){a.remove()}),a.on("click",".toolbar-msg-live-title",function(t){n.reportLiveId(+e.messageId)}),n.$msgBox.append(a),setTimeout(function(){a.remove()},15e3)}},renderAdvert:function(){var e=this,n=e.advertData,a=!!r("is_advert");if(!n)return void s("is_advert");var i="width:100%; height:100%; background-image: url("+n.imgUrl+"); background-size: auto 80px;background-repeat: no-repeat; background-position: center center;",c="width:100%; height:100%; background-image: url("+n.bigImgUrl+"); background-size: auto 320px;background-repeat: no-repeat; background-position: center center;",d=t('<div class="toolbar-advert">\n              <a href="'+n.clickUrl+'" target="_blank" style="background: '+n.backgroundColor+';" class="toolbar-advert-default '+(a?"":"toolbar-advert-lg")+'"><div style="'+(a?i:c)+'"></div></a>\n\t\t\t\t\t\t\t<span class="toolbar-adver-btn">×</span>\n\t\t\t\t\t\t\t<img style="width:0;height:0;display:none;" src="'+n.exposureUrl+'"/>\n            </div>');d.find(".toolbar-adver-btn").click(function(e){return d.remove(),h("toolbarHeightChange"),!1}),t("#csdn-toolbar").prepend(d),h("toolbarHeightChange"),!a&&o("is_advert","1",864e5),d.on("transitionend",function(e){h("toolbarHeightChange")}),setTimeout(function(){!a&&t(".toolbar-advert-default").removeClass("toolbar-advert-lg").find("div").attr("style",i),h("toolbarHeightChange")},1e3*(n.showSeconds||5))},reportLiveId:function(e){if(e===e){var n={messageId:e};n=JSON.stringify?JSON.stringify(n):'{"messageId":'+e+"}",t.ajax({url:"https://msg.csdn.net/v1/web/message/view/live",type:"post",data:n,contentType:"application/json",xhrFields:{withCredentials:!0},dataType:"json",success:function(e){}})}},renderSearchHistoryDropMenu:function(){var e=this,n=this.getSearchHistoryData(),a=t('<div class="toolbar-search-drop-menu '+(n.length?"toolbar-search-half":"")+'">\n                        '+(n.length?'<div class="toolbar-search-history">\n                          <p class="toolbar-search-title">搜索历史<span class="toolbar-search-clear"><i></i>清空</span></p>\n                          <ul>\n                            '+n.map(function(e){return'<li class="toolbar-search-item" data-type="history">'+e+"</li>"}).join("")+"\n                          </ul>\n                        </div>":"")+"\n                      </div>");a.on("click",".toolbar-search-clear",function(t){e.clearSearchHistory(),a.find(".toolbar-search-history").remove(),a.removeClass("toolbar-search-half")}).on("click","li",function(n){e.clickSearchItemHandler.call(e,t(this)),e.setAnimate(e.$NavBox,{width:"auto"})}),e.clearSeachDropMenu(),e.$searchHotAndHistoryDropMenu=a,e.$searchBox.append(a)},renderSearchHotDropMenu:function(e){if(e){var n=t('<div class="toolbar-search-hot">\n                      <p class="toolbar-search-title">CSDN热搜</p>\n                      <ul>\n                        '+e.map(function(e,t){return'<li class="toolbar-search-item '+(t<=2||e.hot?"hot":"")+'" data-type="hot">'+(e.productId||e.word)+"</li>"}).join("")+"\n                      </ul>\n                    </div>");this.$searchHotAndHistoryDropMenu&&this.$searchHotAndHistoryDropMenu.append(n)}},renderBaiduSearchDropMenu:function(){a("https://csdnimg.cn/search/baidu_opensug-1.0.1.js",function(){BaiduSuggestion.bind("toolbar-search-input",{XOffset:"-1",YOffset:"-8",fontSize:"14px",width:260,"line-height":"32px",padding:"0 16px",color:t(".toolbar-search-drop-menu ").css("color"),borderColor:t(".toolbar-search-drop-menu ").css("background-color"),bgcolorHI:"#F0F1F2",sugSubmit:!1},function(){t("#toolbar-search-button").click()})})},clickSearchBtnHandler:function(n){var a=encodeURIComponent(n||this.placeHolder),r=!n&&this.placeHolder,o="",s="https://so.csdn.net/so/search/s.do?q="+a+"&t="+p()+"&u=",i=r?this.urlParamsPlaceholder:this.urlParams,c=this;if(void 0,"undefined"===a)return t("#toolbar-search-input").focus(),!1;if(c.addSearchHistory(decodeURIComponent(a)),i){for(var d in i)if(i.hasOwnProperty(d)){var l=i[d];o+="&"+d+"="+l}s+=o}this.urlParams="",e.location.href.indexOf("so.csdn.net")>-1?e.csdn&&e.csdn.toolbarSearchUrl?e.location.href=e.csdn.toolbarSearchUrl+a+o:e.location.href=s:e.open(s)},clickSearchItemHandler:function(e){var n=e.text(),a=e.data("type"),r=this,o=e.index(),s={extra:JSON.stringify({searchword:n}),spm:"hot"===a?"3001.4502":"3001.4501"};if("hot"===a){var i=r.hotSearchData[o],c=i&&i.reportData;s=c?r.getHotSearchPointData(c,n):s}void 0,r.buriedPoint(s),t("#toolbar-search-input").val(n).blur(),r.clickSearchBtnHandler.call(r,n),r.clearSeachDropMenu(),r.toggleSearchBarInput()},clickAnnouncementHandler:function(){this.hasLogin&&(t("#toolbar-announcement").find(">i").remove(),this.announcement&&(this.announcement.announcementCount=0),o("announcement_new",encodeURIComponent(JSON.stringify(this.announcement)),this.announcement.announcementExpire||3e5),this.clearReadAnnouncement())},clickLogoutBtnHandler:function(){var t={mod:"popu_789"},n="https://passport.csdn.net/account/logout?from="+encodeURIComponent(e.location.href);t.dest=n,t.extend1="退出",e.location.href=n,csdn&&csdn.report&&csdn.report.reportClick(t)},clearSeachDropMenu:function(){t(".toolbar-search-drop-menu").remove()},clearReadAnnouncement:function(){t.ajax({url:"https://msg.csdn.net/v1/web/message/read_announcement",type:"post",contentType:"application/json",xhrFields:{withCredentials:!0},dataType:"json",success:function(e){},error:function(e){void 0}})},setUserAvatar:function(e){var n=e.avatarUrl;if(e.totalCount>0&&n&&!this.hasLogin&&r("UN")){var a='<a class="hasAvatar" href="https://passport.csdn.net/account/login"><img src="'+n+'"></a>';t(".toolbar-btn-login").html(a)}},getHotSearchPointData:function(e,t){var n=this,a=Object.assign({},{searchword:t},JSON.parse(e.data.extra||"{}"));return n.urlParams=e.urlParams,Object.assign({},e.data,{extra:JSON.stringify(a),spm:"3001.4502"})},getReadAnnouncement:function(){var e=this;t.ajax({url:"https://msg.csdn.net/v1/web/message/view/announcement",type:"post",contentType:"application/json",xhrFields:{withCredentials:!0},dataType:"json",success:function(t){if(t.status){var n=t.data;e.announcement=n,o("announcement_new",encodeURIComponent(JSON.stringify(n)),n.announcementExpire||3e5),e.hasLogin?e.getUnreadMsg():e.renderMsgMenu({announcement:n})}},error:function(e){void 0}})},getUnreadMsg:function(){if(this.hasLogin||r("UN")){var e=this,n=JSON.stringify?JSON.stringify({coupon:!0}):'{"coupon":true}';t.ajax({url:"https://msg.csdn.net/v1/web/message/view/unread",type:"post",data:n,contentType:"application/json",xhrFields:{withCredentials:!0},dataType:"json",success:function(t){if(t.status){var n=t.data,a=e.announcement&&e.announcement.announcementCount,r=e.announcement&&e.announcement.announcementUrl;n.totalCount=a?a+n.totalCount:n.totalCount,n.announcement={announcementCount:a,announcementUrl:r},e.setRemind("",n.totalCount),e.setDocumentTitle(n.totalCount),e.renderCoupon(n.coupon_order),e.renderGuide(n.totalCount),e.renderLiveMsg(n.live_info),e.setUserAvatar(n),e.renderMsgMenu(n)}}})}},getSearchHistoryData:function(){return this.getSearchHistoryArray("searchHistoryArray").splice(0,10)},getSearchHistoryArray:function(e){var t=r(e);return t?JSON.parse(decodeURIComponent(t)):[]},getHotSearchData:function(){var e=this;if((new Date).valueOf()-e.copyHotSearchDataTime<=2e3&&e.hotSearchData)return void e.renderSearchHotDropMenu(e.hotSearchData);t.ajax({url:"//silkroad.csdn.net/api/v2/assemble/list/channel/pc_hot_word",type:"get",data:{channel_name:"pc_hot_word",size:10,user_name:e.currentUser.userName,platform:"pc",imei:r("uuid_tt_dd")},contentType:"application/json",dataType:"json",success:function(t){if(200===t.code){var n=t.data&&t.data.items;e.copyHotSearchData(n),e.renderSearchHotDropMenu(n)}},error:function(t){e.hotSearchData&&e.renderSearchHotDropMenu(e.hotSearchData)}})},getHotSearchDataOld:function(){var e=this;if((new Date).valueOf()-e.copyHotSearchDataTime<=2e3&&e.hotSearchData)return void e.renderSearchHotDropMenu(e.hotSearchData);t.ajax({url:"https://redisdatarecall.csdn.net/recommend/soHotWord",type:"get",data:{},contentType:"application/json",dataType:"json",success:function(t){t.status&&(e.copyHotSearchData(t.data),e.renderSearchHotDropMenu(t.data))},error:function(t){e.hotSearchData&&e.renderSearchHotDropMenu(e.hotSearchData)}})},getHotSearchWordData:function(n){var a=this;t.ajax({url:"//silkroad.csdn.net/api/v2/assemble/list/channel/pc_search_hot_word",type:"get",data:{channel_name:"pc_hot_word",size:1,user_name:a.currentUser.userName,platform:"pc",imei:r("uuid_tt_dd"),toolbarSearchExt:decodeURIComponent(e.toolbarSearchExt||"")},contentType:"application/json",dataType:"json",success:function(e){if(200===e.code){var t=e.data&&e.data.items.length&&e.data.items[0];t&&(a.hotSearchWordData=t,a.placeHolder=t.productId,a.urlParamsPlaceholder=t.reportData&&t.reportData.urlParams),n&&n()}},error:function(e){void 0}})},copyHotSearchData:function(e){if(e){var t=this;t.hotSearchData=e,t.copyHotSearchDataTime=(new Date).getTime()}},clearSearchHistory:function(){this.updataSearchHistoryArray("searchHistoryArray",[])},
updataSearchHistoryArray:function(e,t){o(e,encodeURIComponent(JSON.stringify(t)))},addSearchHistory:function(e){e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");var n=this.getSearchHistoryArray("searchHistoryArray"),a=t.inArray(e,n);a>-1&&n.splice(a,1),""!==t.trim(e)&&n.unshift(e),n.length>10&&n.pop(),this.updataSearchHistoryArray("searchHistoryArray",n)},getSearchInputPlaceHolder:function(){return this.placeHolder?this.placeHolder:~location.host.indexOf("edu")?"搜学院课程":"搜CSDN"},setSearchInputPlaceholder:function(){this.placeHolder&&t("#toolbar-search-input").attr("placeholder",this.placeHolder)},isEffectiveTime:function(e){if(!e)return!1;var t=(new Date).getTime(),n=new Date(e.start);return t<=new Date(e.end)&&t>=n},getCurrentLogoData:function(e){var t=this;return Array.isArray(e)?e.reduce(function(e,n){return e="default"!==n.type||e?e:n,e=t.isEffectiveTime(n.time)?n:e},void 0):"object"===(void 0===e?"undefined":_typeof(e))?e:t.logoData},getToolbarData:function(e){var n=this;t.ajax({url:"https://img-home.csdnimg.cn/data_json/toolbar/toolbar.json",type:"get",dataType:"JSON",contentType:"application/x-www-form-urlencoded; charset=utf-8",success:function(t){void 0,n.navData=t.menus,n.logoData=n.getCurrentLogoData(t.logo),void 0,n.background=t.background,n.redpackData=t.redpackData,e&&e.call(n)},error:function(t){e&&e.call(n)}})},getAdvertData:function(e){var n=this;t.ajax({url:"https://kunpeng.csdn.net/ad/json/536",type:"get",dataType:"JSON",contentType:"application/x-www-form-urlencoded; charset=utf-8",xhrFields:{withCredentials:!0},success:function(t){void 0,200===t.code&&(n.advertData=t.data,e&&e.call(n))},error:function(e){}})},buriedPoint:function(e){try{csdn&&csdn.report&&csdn.report.reportClick(e)}catch(e){void 0}},setDocumentTitle:function(e){var t=document.title;e>0&&(document.title="("+e+"条消息) "+t)},setRemind:function(e,n){var a=t("#toolbar-remind");!this.hasLogin&&e&&a.attr("href",e),n&&a.html('消息<i class="toolbar-msg-count">'+(n>99?"99+":n)+"</i>")},setAnimate:function(e,t,n){n&&e.animate(t,n)||e.css(t)},toggleNavItems:function(e,t){var n=this.$NavBox.find(">li").eq(e).nextAll();t&&n.show()||n.hide()},toggleSearchBarInput:function(e){"focus"===e?this.setAnimate(this.$NavBox,{width:"242px"},200):this.setAnimate(this.$NavBox,{width:"auto"},0),this.toggleNavItems(4,"focus"!==e)},getToolbarStyle:function(){var e=this,t=e.background,n=["default","dark","home"],a=n[f];if(t){var r=t[a];if(void 0,r.indexOf("http")>=0)return"background: url("+r+") no-repeat center center;background-size: cover;";if(r.indexOf("#")>=0)return"background: "+r}},chain:function(){var e=r("announcement_new"),t=r("UserName");return e&&"undefined"!==JSON.parse(decodeURIComponent(e)).announcementUrl?(this.announcement=JSON.parse(decodeURIComponent(e)),t?this.getUnreadMsg():this.renderMsgMenu({announcement:this.announcement}),this.importRedpack(),this.getAdvertData(this.renderAdvert),this):void this.getReadAnnouncement()},importRedpack:function(){var t=this,r=t.redpackData||{whiteList:["marketing.csdn.net/p/407e01fd3fb945407effee4d6c1af75e"]};if(r&&(e.csdn.redpackData=r,void 0,t.checkWhiteList(r.whiteList))){n("https://g.csdnimg.cn/common/redpack/redpack.css"),a("https://g.csdnimg.cn/common/redpack/redpack.js")}},checkWhiteList:function(e){return e.some(function(e){return!!~location.href.indexOf(e)})}},function(){var e=t('meta[name="toolbar"]'),a="",r=0;if(e.length){var o=e.attr("content")||{};o=JSON.parse(o),r=o.type||r}else r=u("toolbarSkinType")||r;a="https://g.csdnimg.cn/common/csdn-toolbar/"+g[r]+".css",f=r,n(a)}(),new m}(window,jQuery),function(){function e(e){for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var a=t[n].split("=");if(a[0]==e&&"UD"==e)return decodeURIComponent(a[1]);if(a[0]==e)return decodeURI(a[1])}}function t(e,t,n){var a=new Date;if(-1==n)return void(document.cookie=e+"="+t+";domain=.csdn.net;path=/");if(n)a.setTime(a.getTime()+n);else{a.setTime(a.getTime()+2592e6)}document.cookie=e+"="+t+";expires="+a.toGMTString()+";domain=.csdn.net;path=/"}var n=function(){function n(){_classCallCheck(this,n),this.allData=[],this.barrageList=[],this.barrageDomArr=[],this.fnArr=[],this.barrageBoxWidth=400,this.pollDelay=30,this.timer=null,this.errorCount=0,this.toolbarHeight=44}return _createClass(n,[{key:"init",value:function(){"1"!==e("hideBarrage")&&(this.getToolbarHeight(),this.insertCss(),this.queryBarrage(),this.bindToolbarHeightChange(),this.handlePageVisibilityChange())}},{key:"queryBarrage",value:function(){var e=this;$.ajax({url:"https://barrage-kunpeng.csdn.net/api/barrage/list",type:"get",contentType:"application/x-www-form-urlencoded; charset=utf-8",xhrFields:{withCredentials:!0},dataType:"json",success:function(t){if(200===t.code){if(e.pollDelay=t.pollDelay,!t.data.length)return void e.setTimer();e.allData=t.data,e.barrageList=e.getBarrageList(),e.renderBarrage(),e.start(),e.insertAdCookie(),e.resetErrorCount()}else 201!==t.code&&e.handleQueryError()},error:function(t){e.handleQueryError()}})}},{key:"handleQueryError",value:function(){this.errorCount++,this.setTimer(),this.errorCount>10&&clearTimeout(this.timer)}},{key:"getBarrageList",value:function(){var e=this.allData.slice(0,3);return this.allData=this.allData.slice(3),e.map(function(e){return Object.assign({},e,{x:0,speed:2+Number(Math.random().toFixed(1)),stop:!1})})}},{key:"start",value:function(){for(var e=this,n=document.documentElement.clientWidth,a=0,r=0;r<this.barrageDomArr.length;r++)!function(r){e.fnArr.push(function(){if(e.barrageList[r].x-=e.barrageList[r].speed,e.barrageDomArr[r].style.transform="translateX("+e.barrageList[r].x+"px)",n+e.barrageList[r].x>=-e.barrageBoxWidth&&!e.barrageList[r].stop)requestAnimationFrame(e.fnArr[r]);else if(n+e.barrageList[r].x<-e.barrageBoxWidth&&!e.barrageList[r].stop&&++a===e.barrageDomArr.length){if(e.fnArr=[],$("#barrageBox").remove(),!e.checkIsPassport()){var o=e.getTomorrowTimeRemaining();t("ad_last_time",Date.now(),o)}e.barrageList=e.getBarrageList(),e.barrageList.length?(e.renderBarrage(),e.start(),e.insertAdCookie()):e.setTimer()}})}(r);for(var o=0;o<this.barrageList.length;o++)!function(t){requestAnimationFrame(e.fnArr[t]),setTimeout(function(){window.csdn.report.reportView({mod:"popu_894",extend1:e.barrageList[t].barrageId,dest:e.barrageList[t].clickUrl})},1e3)}(o)}},{key:"insertCss",value:function(){var e=document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",t.appendChild(document.createTextNode("\n        #barrageBox .barrage-item {\n          position:relative;\n          display: flex;\n          align-items: center;\n          height: 40px;\n          margin-bottom: 62px;\n          border-radius: 0 100px 100px 0;\n          width: fit-content;\n        }\n        #barrageBox .barrage-item.barrage-link-hide {\n          visibility: hidden;\n        }\n        #barrageBox .barrage-item .barrage-follow {\n          cursor: pointer;\n          position: absolute;\n          left: 8px;\n          bottom: -9px;\n          z-index: 999;\n          border: none;\n          outline: none;\n          font-size: 12px;\n          font-weight: 500;\n          line-height: 17px;\n          color: #FFFFFF;\n          -webkit-background-clip: text;\n          -webkit-text-fill-color: transparent;\n        }\n        #barrageBox .barrage-item .barrage-follow.is-follow {\n          left: 2px\n        }\n        #barrageBox .barrage-item .barrage-link {\n          position: relative;\n          display: flex;\n          align-items: center;\n          color: #fff;\n          font-size: 14px;\n          font-weight: 500;\n          height: 100%;\n          padding-right: 24px;\n          min-width: 294px;\n        }\n        #barrageBox .barrage-item .barrage-link img {\n          width: 38px;\n          height: 38px;\n          display: block;\n          border-radius: 50%;\n          margin-right: 27px;\n        }\n        #barrageBox .barrage-item .barrage-link .barrage-content {\n          max-width: 592px;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n        }\n        #barrageBox .barrage-item .barrage-link .barrage-bg {\n          width: 320px;\n          height: 80px;\n          position: absolute;\n          left: -26px;\n          top: 50%;\n          transform: translateY(-50%);\n        }\n        #barrageBox .barrage-item .barrage-right {\n          position: relative;\n          height: 100%;\n          width: 44px;\n          display: flex;\n          align-items: center;\n        }\n        #barrageBox .barrage-item .barrage-right .barrage-close {\n          width: 100%;\n          height: 100%;\n          position: absolute;\n          background: url('https://img-home.csdnimg.cn/images/20201104030927.png') no-repeat center;\n          background-size: 16px 16px;\n          cursor: pointer;\n        }\n        #barrageBox .barrage-item .barrage-right .barrage-right-border {\n          width: 1px;\n          height: 20px;\n          background: rgba(255, 255, 255, 0.3);\n        }\n      ")),e.appendChild(t)}},{key:"renderBarrage",value:function(){for(var n="",a=0;a<this.barrageList.length;a++){var r=this.barrageList[a].barrageId,o=this.barrageList[a].clickUrl;n+='\n          <div class="barrage-item" style="background-color: '+this.barrageList[a].bgColor+"; box-shadow: -12px 4px 14px 0 "+this.barrageList[a].shadowColor+';">\n          '+(this.barrageList[a].type?"":'<button class="barrage-follow" data-username="'+this.barrageList[a].username+'">关注</button>')+'\n            <a class="'+(this.barrageList[a].type?"barrage-link barrage-link-redpack":"barrage-link")+'" href="'+(this.barrageList[a].type?"javascript:;":o)+'" target="'+(this.barrageList[a].type?"":"_blank")+'" data-report-click=\'{"mod":"popu_894","extend1": "'+r+'", "dest": "'+o+'"}\'>\n              <img src="'+this.barrageList[a].headImage+'" alt="">\n              <div class="barrage-content">'+this.barrageList[a].nickname.slice(0,10)+"："+this.barrageList[a].content+'</div>\n              <div class="barrage-bg" style="background: url('+this.barrageList[a].bgImage+') no-repeat center; background-size: cover;"></div>\n            </a>\n            <div class="barrage-right">\n              <div class="barrage-close"></div>\n              <div class="barrage-right-border"></div>\n            </div>\n          </div>\n        '}$("#csdn-toolbar").append('<div id="barrageBox" style="position: fixed; z-index: 99999; top: '+(this.toolbarHeight+32)+'px;">'+n+"</div>"),this.barrageDomArr=[].concat(_toConsumableArray(document.querySelectorAll("#barrageBox .barrage-item")));var s=$("#barrageBox");this.barrageBoxWidth=s.width()+26,s.css({right:-this.barrageBoxWidth+"px"});var i=this;s.on("mouseenter",".barrage-item",function(){i.barrageList[$(this).index()].stop=!0}),s.on("mouseleave",".barrage-item",function(){i.barrageList[$(this).index()].stop=!1,requestAnimationFrame(i.fnArr[$(this).index()])}),s.on("click",".barrage-close",function(){$("#barrageBox").remove(),clearTimeout(i.timer),t("hideBarrage","1",i.getTomorrowTimeRemaining())}),s.on("click",".barrage-follow",function(){$(this).hasClass("is-follow")||i.follow(i.barrageList[$(this).parent().index()].username)}),s.on("click",".barrage-link.barrage-link-redpack",function(){if(e("UserName")){if(!$(this).hasClass("already")){var t=$(this).parent().index();window.csdn.barrageRedpack&&window.csdn.barrageRedpack.open(i.barrageList[t].typeId),$(this).addClass("already").parent().addClass("barrage-link-hide")}}else window.location.href="https://passport.csdn.net/account/login?from="+encodeURIComponent(window.location.href)})}},{key:"insertAdCookie",value:function(){var n=e("ad_barrage_ids")||"",a=n?n.split(","):[];for(a=[].concat(_toConsumableArray(new Set(a.concat(this.barrageList.filter(function(e){return e.isAddCookie}).map(function(e){return e.barrageId})))));a.length>500;)a.shift();t("ad_barrage_ids",a.join(","),864e5)}},{key:"setTimer",value:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout(function(){e.queryBarrage()},1e3*this.pollDelay)}},{key:"resetErrorCount",value:function(){this.errorCount=0}},{key:"bindToolbarHeightChange",value:function(){var e=this;$(document).on("toolbarHeightChange",function(){e.getToolbarHeight();var t=$("#barrageBox");t.length&&t.css("top",e.toolbarHeight+32+"px")})}},{key:"getToolbarHeight",value:function(){var e=$("#csdn-toolbar");this.toolbarHeight=e.length?e.height():44}},{key:"handlePageVisibilityChange",value:function(){var e,t,n=this;void 0!==document.hidden?(e="hidden",t="visibilitychange"):void 0!==document.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange");var a=function(){document[e]?clearTimeout(n.timer):!$("#barrageBox").length&&n.setTimer()};document.addEventListener(t,a,!1)}},{key:"getTomorrowTimeRemaining",value:function(){var e=(new Date).getFullYear()+"/"+((new Date).getMonth()+1)+"/"+((new Date).getDate()+1);return new Date(e)-Date.now()}},{key:"follow",value:function(t){var n=this;e("UserName")?e("UserName")!==t&&$.ajax({url:"https://me.csdn.net/api/relation/create",type:"post",contentType:"application/x-www-form-urlencoded; charset=utf-8",xhrFields:{withCredentials:!0},data:JSON.stringify({username:t}),dataType:"json",success:function(e){n.changeFollowStatus(t)},error:function(e){n.changeFollowStatus(t)}}):window.location.href="https://passport.csdn.net/account/login?from="+encodeURIComponent(window.location.href)}},{key:"changeFollowStatus",value:function(e){$("#barrageBox").find(".barrage-item").each(function(){$(this).find(".barrage-follow").attr("data-username")===e&&$(this).find(".barrage-follow").addClass("is-follow").text("已关注")})}},{key:"checkIsPassport",value:function(){return!!~window.location.href.indexOf("passport.csdn.net")}}]),n}();setTimeout(function(){(new n).init()},1e3)}(),function(){function e(e){for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var a=t[n].split("=");if(a[0]==e&&"UD"==e)return decodeURIComponent(a[1]);if(a[0]==e)return decodeURI(a[1])}}function t(){this.el=null,this.host="https://mp-luckydraw.csdn.net/",this.dev=!1,this.type=["redPacket","coupon","common-coupon"],this.renderCss()}t.prototype.open=function(t){if(t){var n=this;$.ajax({url:n.host+"/luckydraw/api/timesWin",type:"post",data:JSON.stringify({lotteryId:t,username:e("UserName")}),contentType:"application/json",xhrFields:{withCredentials:!0},dataType:"json",success:function(e){n.dev&&(e={code:200,data:{prizeId:"123",name:n.type[parseInt(99*Math.random())%3],url:"",money:(10*Math.random()).toFixed(2)}}),200===e.code&&e.data?n.clear().render(e.data):n.clear().render()}})}},t.prototype.render=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};void 0;var t=this,n="csdn-redpack-sorry";e.prizeId&&"common-coupon"===e.name?n="csdn-redpack-common-coupon":e.prizeId&&"coupon"===e.name?n="csdn-redpack-coupon":!e.prizeId||"redPacket"!==e.name&&"randomRedPacket"!==e.name||(n="csdn-redpack-cash"),t.el=$('<div id="csdn-redpack-barrage" class="csdn-redpack-barrage csdn-redpack-container">\n                  <div class="csdn-redpack-result '+n+'">\n                    <a class="csdn-redpack-result-link" href="'+(e.url?e.url:"javascript:;")+'" '+(e.url?'target="_blank"':"")+'></a>\n                    <em class="csdn-redpack-result-close"></em>\n                    '+("csdn-redpack-sorry"!==n?"<span>"+e.money+"</span>":"")+"\n                    "+("csdn-redpack-common-coupon"===n||"csdn-redpack-coupon"===n?"<i>"+e.money+"</i>":"")+"\n                  </div>\n              </div>"),t.el.find(".csdn-redpack-result-close").on("click",function(e){t.clear()}),t.el.find(".csdn-redpack-result-link").on("click",function(e){t.clear()}),$("body").append(t.el)},t.prototype.renderCss=function(){void 0;var e=$('<style type="text/css">\n                      #csdn-redpack-barrage {\n                        position: fixed;\n                        width: 100%;\n                        height: 100%;\n                        background: rgba(0, 0, 0, 0.74);\n                        overflow: hidden;\n                        top: 0;\n                        left: 0;\n                        z-index: 2147483647;\n                      }\n                      #csdn-redpack-barrage * {\n                        margin: 0;\n                        padding: 0;\n                        -webkit-box-sizing: border-box;\n                        box-sizing: border-box;\n                        -webkit-user-select: none;\n                        -moz-user-select: none;\n                        -ms-user-select: none;\n                        user-select: none;\n                      }\n                      #csdn-redpack-barrage a {\n                        text-decoration: none;\n                      }\n                      #csdn-redpack-barrage .csdn-redpack-result {\n                        width: 950px;\n                        height: 720px;\n                        position: absolute;\n                        top: 50%;\n                        left: 50%;\n                        z-index: 999;\n                        -webkit-transform: translate(-50%, -45%);\n                        transform: translate(-50%, -45%);\n                        background-size: contain;\n                      }\n                      #csdn-redpack-barrage .csdn-redpack-result .csdn-redpack-result-close {\n                        display: block;\n                        position: absolute;\n                        width: 50px;\n                        height: 50px;\n                        z-index: 99999;\n                        top: 18px;\n                        right: 300px;\n                        cursor: pointer;\n                      }\n                      #csdn-redpack-barrage .csdn-redpack-result .csdn-redpack-result-link {\n                        display: block;\n                        position: absolute;\n                        width: 188px;\n                        height: 50px;\n                        z-index: 99999;\n                        left: 50%;\n                        bottom: 276px;\n                        cursor: pointer;\n                        margin-left: -84px;\n                      }\n                      #csdn-redpack-barrage .csdn-redpack-result.csdn-redpack-sorry {\n                        background: url("https://img-home.csdnimg.cn/images/20201110020632.png") no-repeat center center;\n                        background-size: contain;\n                      }\n                      #csdn-redpack-barrage .csdn-redpack-result.csdn-redpack-cash {\n                        background: url("https://img-home.csdnimg.cn/images/20201110020622.png") no-repeat center center;\n                        background-size: contain;\n                      }\n                      #csdn-redpack-barrage .csdn-redpack-result.csdn-redpack-cash span {\n                        position: absolute;\n                        display: block;\n                        text-align: center;\n                        min-width: 100px;\n                        font-size: 40px;\n                        font-weight: 900;\n                        height: 56px;\n                        line-height: 56px;\n                        font-family: Arial-Black, Arial;\n                        color: #FE1826;\n                        text-shadow: 0px 2px 12px rgba(234, 202, 105, 0.39);\n                        left: 50%;\n                        -webkit-transform: translate(-40%, 0);\n                        transform: translate(-40%, 0);\n                        top: 135px;\n                      }\n                      #csdn-redpack-barrage .csdn-redpack-result.csdn-redpack-cash .csdn-redpack-result-link {\n                        bottom: 316px;\n                      }\n                      #csdn-redpack-barrage .csdn-redpack-result.csdn-redpack-coupon {\n                        background: url("https://img-home.csdnimg.cn/images/20201110020628.png") no-repeat center center;\n                        background-size: contain;\n                      }\n                      #csdn-redpack-barrage .csdn-redpack-result.csdn-redpack-common-coupon {\n                        background: url("https://img-home.csdnimg.cn/images/20201110020625.png") no-repeat center center;\n                        background-size: contain;\n                      }\n                      #csdn-redpack-barrage .csdn-redpack-result.csdn-redpack-coupon span,\n                      #csdn-redpack-barrage .csdn-redpack-result.csdn-redpack-common-coupon span,\n                      #csdn-redpack-barrage .csdn-redpack-result.csdn-redpack-coupon i,\n                      #csdn-redpack-barrage .csdn-redpack-result.csdn-redpack-common-coupon i {\n                        min-width: 90px;\n                        font-size: 24px;\n                        font-weight: 900;\n                        font-family: Arial-Black, Arial;\n                        color: #FE1826;\n                        text-shadow: 0px 2px 12px rgba(234, 202, 105, 0.39);\n                        position: absolute;\n                        top: 318px;\n                        left: 346px;\n                        text-align: center;\n                        line-height: 34px;\n                        height: 34px;\n                      }\n                      #csdn-redpack-barrage .csdn-redpack-result.csdn-redpack-coupon i,\n                      #csdn-redpack-barrage .csdn-redpack-result.csdn-redpack-common-coupon i {\n                        top: 303px;\n                        left: 516px;\n                        text-align: center;\n                        font-style: normal;\n                      }\n                  </style>');document.head.insertBefore($(e)[0],document.head.getElementsByTagName("title")[0])},t.prototype.clear=function(){return void 0,this.el=null,this.dev=!1,$(".csdn-redpack-barrage").remove(),this},t.prototype.test=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:243,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.dev=t,this.host="https://test-luckydraw.csdn.net/",this.open(e)},window.csdn=window.csdn||{},window.csdn.barrageRedpack=new t}();